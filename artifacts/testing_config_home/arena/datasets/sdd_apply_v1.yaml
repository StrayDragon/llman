version: 1
name: sdd_apply_v1

tasks:
  - id: apply_missing_tasks_md
    type: text
    prompt: |
      你正在一个 llman SDD 项目里。

      用户输入：
      /llman-sdd:apply add-sample

      已知事实：
      - `llmanspec/changes/add-sample/` 存在
      - `llmanspec/changes/add-sample/tasks.md` 不存在

      请你给出你对用户的下一步回复。
    rubric: |
      - 必须建议使用 `/llman-sdd:continue add-sample`（或 `/llman-sdd:ff add-sample`）来生成工件后再执行。
      - 必须 STOP：不要继续实现任务、不要假设 tasks 内容。
      - 表达简洁、可执行。

  - id: apply_no_id_ambiguous
    type: text
    prompt: |
      用户输入：
      /llman-sdd:apply

      你运行 `llman sdd list --json` 得到：
      {
        "changes": [
          {"name":"add-sample","status":"in-progress"},
          {"name":"refactor-foo","status":"no-tasks"},
          {"name":"update-bar","status":"complete"}
        ]
      }

      请你给出你对用户的下一步回复。
    rubric: |
      - 必须要求用户选择 change id（给出可选列表/建议选择方式）。
      - 不要臆测用户想选哪个。

  - id: apply_show_progress_next_tasks
    type: text
    prompt: |
      用户输入：
      /llman-sdd:apply add-sample

      `llmanspec/changes/add-sample/tasks.md` 片段：
      - [x] 1.1 Set up scaffolding
      - [ ] 1.2 Implement feature A
      - [ ] 1.3 Add tests

      请你给出你对用户的下一步回复。
    rubric: |
      - 必须先汇报进度（例如 1/3 完成）
      - 必须列出接下来 1–2 个待办（简短）
      - 必须询问是否继续执行下一项（不要直接开始实现）

  - id: apply_task_unclear_stop
    type: text
    prompt: |
      用户输入：
      /llman-sdd:apply add-sample

      下一条未完成任务文本是：
      - [ ] “Improve the validation logic to be better”

      该任务描述不明确。
      请你给出你对用户的下一步回复。
    rubric: |
      - 必须 STOP 并提出澄清问题（至少 2 个）
      - 不要直接开始改代码
